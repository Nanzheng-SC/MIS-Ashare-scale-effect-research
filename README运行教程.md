# A股市场规模效应研究 - 运行教程

## 程序简介

本程序用于研究A股市场的规模效应，通过对不同市值规模的股票进行分析和可视化，探索小市值股票是否存在超额收益。

## 文件结构说明

```
Scale_effect_research/
├── data/         # 存储抓取的股票数据
├── logs/         # 存储运行日志
├── results/      # 存储生成的图表和分析结果
├── src/          # 源代码目录
│   ├── data_fetch.py    # 数据抓取模块
│   ├── data_process.py  # 数据处理模块
│   └── visualization.py # 可视化分析模块
├── requirements.txt     # 依赖包列表
└── README运行教程.md     # 本教程文件
```

## 运行环境准备

### 1. 安装Python
确保您的系统已安装Python 3.7或更高版本。

### 2. 安装依赖包
在项目根目录下运行以下命令安装所需的依赖包：

```bash
pip install -r requirements.txt
```

## 分步运行指南

本程序采用分步运行模式，请按照以下步骤依次执行：

### 第一步：运行数据抓取程序

```bash
python src/data_fetch.py
```

**功能说明：**
- 从A股市场获取股票数据（当前使用模拟数据）
- 每只股票的数据会单独保存为CSV文件
- 数据将保存在 `data` 文件夹中
- 运行日志保存在 `logs/data_fetch.log` 中

**参数调整：**
如需调整数据获取参数，请修改 `src/data_fetch.py` 文件中的以下变量：
- `start_date`: 开始日期（格式：YYYYMMDD）
- `end_date`: 结束日期（格式：YYYYMMDD）
- `max_stocks`: 最大股票数量
- `use_mock_data`: 是否使用模拟数据（True/False）

### 第二步：运行可视化分析程序

在确认数据已成功获取后，运行以下命令：

```bash
python src/visualization.py
```

**功能说明：**
- 读取 `data` 文件夹中的股票数据
- 按照市值将股票分为5个组
- 计算各组的收益率、波动率、夏普比率等指标
- 生成多种可视化图表
- 图表将保存在 `results` 文件夹中
- 运行日志保存在 `logs/visualization.log` 中

## 分析结果说明

### 生成的图表

运行可视化程序后，将在 `results` 文件夹中生成以下图表：

1. **市值分布.png** - 展示不同市值组的股票分布情况
2. **年化收益率对比.png** - 对比各市值组的年化收益率
3. **波动率对比.png** - 对比各市值组的波动率
4. **夏普比率对比.png** - 对比各市值组的夏普比率
5. **累计收益率曲线.png** - 展示各市值组的累计收益率走势
6. **规模效应综合分析.png** - 综合分析A股市场规模效应

### 规模效应解释

规模效应是指小市值股票相对于大市值股票存在超额收益的现象。

- 如果小市值组的收益率高于大市值组，则存在正规模效应
- 如果小市值组的收益率低于大市值组，则不存在正规模效应

程序会自动计算并显示规模效应溢价（小市值组收益率 - 大市值组收益率）。

## 常见问题排查

### 数据获取失败
- 检查网络连接（如果使用真实数据）
- 查看 `logs/data_fetch.log` 中的错误信息
- 尝试使用模拟数据（设置 `use_mock_data = True`）

### 可视化出错
- 确保 `data` 文件夹中有有效的股票数据文件
- 检查 `logs/visualization.log` 中的错误信息
- 确认所有依赖包已正确安装

### 文件夹权限问题
- 确保程序有写入 `data`、`logs` 和 `results` 文件夹的权限
- 可以手动创建这些文件夹再运行程序

## 注意事项

1. **数据量控制**：默认设置下，程序使用模拟数据生成50只股票的历史数据。如需获取更多股票数据，请调整 `max_stocks` 参数。

2. **时间范围**：模拟数据的时间范围可以通过 `start_date` 和 `end_date` 参数调整。

3. **性能考虑**：处理大量股票数据时，程序可能需要较长时间运行。建议先使用少量数据进行测试。

4. **日志查询**：所有操作日志都保存在 `logs` 文件夹中，如遇问题请优先查看相关日志文件。

---

如有任何问题或建议，请随时联系开发人员。

祝您研究顺利！